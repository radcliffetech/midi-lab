<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Browser Drum Pad</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #fff;
      color: #000;
    }
    .pad-grid {
      display: grid;
      grid-template-columns: repeat(4, 80px);
      grid-gap: 10px;
      justify-content: center;
      margin-top: 50px;
    }
    .pad {
      width: 80px;
      height: 80px;
      background-color: #e0e0e0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      color: #333;
      transition: background 0.2s, color 0.2s;
    }
    .pad:hover {
      background-color: #d0d0d0;
    }
    .pad:active {
      background-color: #0d6efd;
      color: #fff;
    }
    .midi-output-select {
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container">
      <a class="navbar-brand" href="/index.html">MIDI Live Tools</a>
    </div>
  </nav>
<div class="container text-center">
  
  <h1 class="mt-4">Browser Drum Pad</h1>

  <div class="midi-output-select">
    <label for="outputSelect" class="form-label">MIDI Output Device:</label>
    <select id="outputSelect" class="form-select w-auto mx-auto"></select>
  </div>

  <div id="pad-grid" class="pad-grid">
    <!-- Pads generated by JS -->
  </div>
</div>

<script>
let midiOutput = null;

// Define your drum pad notes (basic GM drum mapping)
const pads = [
  { name: 'Kick', note: 36 },
  { name: 'Snare', note: 38 },
  { name: 'Clap', note: 39 },
  { name: 'Hi-Hat Closed', note: 42 },
  { name: 'Hi-Hat Open', note: 46 },
  { name: 'Tom Low', note: 41 },
  { name: 'Tom Mid', note: 45 },
  { name: 'Tom High', note: 48 },
  { name: 'Crash 1', note: 49 },
  { name: 'Crash 2', note: 57 },
  { name: 'Ride', note: 51 },
  { name: 'Perc 1', note: 47 },
  { name: 'Perc 2', note: 50 },
  { name: 'Perc 3', note: 53 },
  { name: 'Perc 4', note: 55 },
  { name: 'Perc 5', note: 60 }
];

navigator.requestMIDIAccess().then(midiAccess => {
  const outputSelect = document.getElementById('outputSelect');
  
  midiAccess.outputs.forEach((output, id) => {
    const option = document.createElement('option');
    option.value = id;
    option.textContent = output.name;
    outputSelect.appendChild(option);
  });

  outputSelect.addEventListener('change', () => {
    const selectedId = outputSelect.value;
    midiOutput = [...midiAccess.outputs.values()].find(output => output.id === selectedId) || null;
  });

  if (midiAccess.outputs.size > 0) {
    midiOutput = [...midiAccess.outputs.values()][0];
    outputSelect.value = midiOutput.id;
  }
});

function sendMidiNote(note, velocity = 100) {
  if (!midiOutput) return;
  const noteOn = [0x90, note, velocity];
  const noteOff = [0x80, note, 0];
  midiOutput.send(noteOn);
  setTimeout(() => midiOutput.send(noteOff), 100);
}

// Build the pad grid
const padGrid = document.getElementById('pad-grid');
pads.forEach(pad => {
  const button = document.createElement('button');
  button.className = 'pad';
  button.textContent = pad.name;
  button.dataset.note = pad.note;
  button.addEventListener('click', () => {
    sendMidiNote(parseInt(button.dataset.note));
  });
  padGrid.appendChild(button);
});
</script>

</body>
</html>